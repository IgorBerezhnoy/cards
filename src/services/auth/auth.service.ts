import { LoginParams, PatchUserType, SingUpFormData, User } from '@/services/auth/auth.types'
import { baseApiService } from '@/services/baseApi/base-api.service'

const authService = baseApiService.injectEndpoints({
  endpoints: builder => {
    return {
      login: builder.mutation<void, LoginParams>({
        invalidatesTags: ['Me'],
        query: body => ({
          body,
          method: 'POST',
          url: '/v1/auth/login',
        }),
      }),
      logout: builder.mutation<void, void>({
        invalidatesTags: ['Me'],
        query: () => ({
          method: 'POST',
          url: '/v1/auth/logout',
        }),
      }),
      me: builder.query<User, void>({
        providesTags: ['Me'],
        query: () => `v1/auth/me`,
      }),
      patchUser: builder.mutation<User, PatchUserType>({
        invalidatesTags: ['Me'],
        query: body => ({
          body,
          method: 'PATCH',
          url: '/v1/auth/me',
        }),
      }),
      recoverPassword: builder.mutation<void, { email: string }>({
        query: email => ({
          body: {
            ...email,
            html: '\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"\n  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\n<head>\n  <style type="text/css">.rollover:hover .rollover-first {\n      max-height: 0 !important;\n      display: none !important;\n  }\n\n  .rollover:hover .rollover-second {\n      max-height: none !important;\n      display: inline-block !important;\n  }\n\n  .rollover div {\n      font-size: 0;\n  }\n\n  u ~ div img + div > div {\n      display: none;\n  }\n\n  #outlook a {\n      padding: 0;\n  }\n\n  span.MsoHyperlink, span.MsoHyperlinkFollowed {\n      color: inherit;\n  }\n\n  a.es-button {\n      text-decoration: none !important;\n  }\n\n  a[x-apple-data-detectors] {\n      color: inherit !important;\n      text-decoration: none !important;\n      font-size: inherit !important;\n      font-family: inherit !important;\n      font-weight: inherit !important;\n      line-height: inherit !important;\n  }\n\n  .es-desk-hidden {\n      display: none;\n      float: left;\n      overflow: hidden;\n      width: 0;\n      max-height: 0;\n      line-height: 0;\n      mso-hide: all;\n  }\n\n  .es-header-body a:hover {\n      color: #666666 !important;\n  }\n\n  .es-content-body a:hover {\n      color: #5c68e2 !important;\n  }\n\n  .es-footer-body a:hover {\n      color: #333333 !important;\n  }\n\n  .es-infoBlock a:hover {\n      color: #cccccc !important;\n  }\n\n  .es-button-border:hover > a.es-button {\n      color: #ffffff !important;\n  }\n\n  @media only screen and (max-width: 600px) {\n      .es-m-p0r {\n          padding-right: 0 !important\n      }\n\n      .es-m-p0r {\n          padding-right: 0 !important\n      }\n\n      .es-m-p0l {\n          padding-left: 0 !important\n      }\n\n      *[class="gmail-fix"] {\n          display: none !important\n      }\n\n      p, a {\n          line-height: 150% !important\n      }\n\n      h1, h1 a {\n          line-height: 120% !important\n      }\n\n      h2, h2 a {\n          line-height: 120% !important\n      }\n\n      h3, h3 a {\n          line-height: 120% !important\n      }\n\n      h4, h4 a {\n          line-height: 120% !important\n      }\n\n      h5, h5 a {\n          line-height: 120% !important\n      }\n\n      h6, h6 a {\n          line-height: 120% !important\n      }\n\n      .es-header-body p {\n      }\n\n      .es-content-body p {\n      }\n\n      .es-footer-body p {\n      }\n\n      .es-infoBlock p {\n      }\n\n      h1 {\n          font-size: 36px !important;\n          text-align: left\n      }\n\n      h2 {\n          font-size: 26px !important;\n          text-align: left\n      }\n\n      h3 {\n          font-size: 20px !important;\n          text-align: left\n      }\n\n      h4 {\n          font-size: 24px !important;\n          text-align: left\n      }\n\n      h5 {\n          font-size: 20px !important;\n          text-align: left\n      }\n\n      h6 {\n          font-size: 16px !important;\n          text-align: left\n      }\n\n      .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a {\n          font-size: 36px !important\n      }\n\n      .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a {\n          font-size: 26px !important\n      }\n\n      .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a {\n          font-size: 20px !important\n      }\n\n      .es-header-body h4 a, .es-content-body h4 a, .es-footer-body h4 a {\n          font-size: 24px !important\n      }\n\n      .es-header-body h5 a, .es-content-body h5 a, .es-footer-body h5 a {\n          font-size: 20px !important\n      }\n\n      .es-header-body h6 a, .es-content-body h6 a, .es-footer-body h6 a {\n          font-size: 16px !important\n      }\n\n      .es-menu td a {\n          font-size: 12px !important\n      }\n\n      .es-header-body p, .es-header-body a {\n          font-size: 14px !important\n      }\n\n      .es-content-body p, .es-content-body a {\n          font-size: 14px !important\n      }\n\n      .es-footer-body p, .es-footer-body a {\n          font-size: 14px !important\n      }\n\n      .es-infoBlock p, .es-infoBlock a {\n          font-size: 12px !important\n      }\n\n      .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3, .es-m-txt-c h4, .es-m-txt-c h5, .es-m-txt-c h6 {\n          text-align: center !important\n      }\n\n      .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3, .es-m-txt-r h4, .es-m-txt-r h5, .es-m-txt-r h6 {\n          text-align: right !important\n      }\n\n      .es-m-txt-j, .es-m-txt-j h1, .es-m-txt-j h2, .es-m-txt-j h3, .es-m-txt-j h4, .es-m-txt-j h5, .es-m-txt-j h6 {\n          text-align: justify !important\n      }\n\n      .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3, .es-m-txt-l h4, .es-m-txt-l h5, .es-m-txt-l h6 {\n          text-align: left !important\n      }\n\n      .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img, .es-m-txt-r .rollover:hover .rollover-second, .es-m-txt-c .rollover:hover .rollover-second, .es-m-txt-l .rollover:hover .rollover-second {\n          display: inline !important\n      }\n\n      .es-m-txt-r .rollover div, .es-m-txt-c .rollover div, .es-m-txt-l .rollover div {\n          line-height: 0 !important;\n          font-size: 0 !important\n      }\n\n      .es-spacer {\n          display: inline-table\n      }\n\n      a.es-button, button.es-button {\n          font-size: 20px !important\n      }\n\n      .es-m-fw, .es-m-fw.es-fw, .es-m-fw .es-button {\n          display: block !important\n      }\n\n      .es-m-il, .es-m-il .es-button, .es-social, .es-social td, .es-menu {\n          display: inline-block !important\n      }\n\n      .es-adaptive table, .es-left, .es-right {\n          width: 100% !important\n      }\n\n      .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header {\n          width: 100% !important;\n          max-width: 600px !important\n      }\n\n      .adapt-img {\n          width: 100% !important;\n          height: auto !important\n      }\n\n      .es-mobile-hidden, .es-hidden {\n          display: none !important\n      }\n\n      .es-desk-hidden {\n          width: auto !important;\n          overflow: visible !important;\n          float: none !important;\n          max-height: inherit !important;\n          line-height: inherit !important\n      }\n\n      tr.es-desk-hidden {\n          display: table-row !important\n      }\n\n      table.es-desk-hidden {\n          display: table !important\n      }\n\n      td.es-desk-menu-hidden {\n          display: table-cell !important\n      }\n\n      .es-menu td {\n          width: 1% !important\n      }\n\n      table.es-table-not-adapt, .esd-block-html table {\n          width: auto !important\n      }\n\n      .es-social td {\n          padding-bottom: 10px\n      }\n\n      .h-auto {\n          height: auto !important\n      }\n\n      a.es-button, button.es-button {\n          display: inline-block !important\n      }\n\n      .es-button-border {\n          display: inline-block !important\n      }\n  }</style><title></title>\n</head>\n<body style="width:100%;height:100%;padding:0;Margin:0">\n<div class="es-wrapper-color" style="background-color:#EFEFEF">\n  <table class="es-wrapper" width="100%" cellspacing="0" cellpadding="0"\n         style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#EFEFEF">\n    <tr>\n      <td valign="top" style="padding:0;Margin:0">\n        <table cellpadding="0" cellspacing="0" class="es-header" align="center"\n               style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0;width:100%;table-layout:fixed !important;background-color:transparent;background-repeat:repeat;background-position:center top">\n          <tr>\n            <td align="center" style="padding:0;Margin:0">\n              <table bgcolor="#ffffff" class="es-header-body" align="center" cellpadding="0" cellspacing="0"\n                     style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0;background-color:transparent;width:600px">\n                <tr>\n                  <td align="left" style="padding:20px;Margin:0">\n                    <table cellpadding="0" cellspacing="0" width="100%"\n                           style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0">\n                      <tr>\n                        <td class="es-m-p0r" valign="top" align="center" style="padding:0;Margin:0;width:560px">\n                          <table cellpadding="0" cellspacing="0" width="100%"\n                                 style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0">\n                            <tr>\n                              <td align="center" style="padding:0;Margin:0;display:none"></td>\n                            </tr>\n                          </table>\n                        </td>\n                      </tr>\n                    </table>\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n        </table>\n        <table cellpadding="0" cellspacing="0" class="es-content" align="center"\n               style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0;width:100%;table-layout:fixed !important">\n          <tr>\n            <td align="center" bgcolor="#efefef" style="padding:0;Margin:0;background-color:#efefef">\n              <table bgcolor="#ffffff" class="es-content-body" align="center" cellpadding="0" cellspacing="0"\n                     style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:separate;border-spacing:0;background-color:#ffffff;width:600px;border-width:0">\n                <tr>\n                  <td align="left"\n                      style="padding:0;Margin:0;padding-top:15px;padding-right:20px;padding-left:20px;border-radius:22px">\n                    <table cellpadding="0" cellspacing="0" width="100%"\n                           style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0">\n                      <tr>\n                        <td align="center" valign="top" style="padding:0;Margin:0;width:554px">\n                          <table cellpadding="0" cellspacing="0" width="100%" \n                                 style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0">\n                            <tr>\n                              <td align="center"\n                                  style="Margin:0;padding-top:10px;padding-bottom:10px;font-size:0"><img\n                                src="https://qlexnd.stripocdn.email/content/guids/CABINET_91d375bbb7ce4a7f7b848a611a0368a7/images/69901618385469411.png"\n                                alt=""\n                                style="display:block;font-size:14px;border:0;outline:none;text-decoration:none;border-radius:0"\n                                width="100" height="100"></td>\n                            </tr>\n                            <tr>\n                              <td align="center" class="es-m-p0r es-m-p0l es-m-txt-c"\n                                  style="Margin:0;padding-right:40px;padding-bottom:15px;padding-left:40px">\n                                <h1\n                                  style="Margin:0;font-family:arial, \'helvetica neue\', helvetica, sans-serif;mso-line-height-rule:exactly;letter-spacing:0;font-size:46px;font-style:normal;font-weight:bold;line-height:55px;color:#333333">\n                                  Сброс пароля</h1></td>\n                            </tr>\n                            <tr>\n                              <td align="left" style="Margin:0;padding-top:10px"><h6\n                                style="Margin:0;font-family:arial, \'helvetica neue\', helvetica, sans-serif;mso-line-height-rule:exactly;letter-spacing:0;font-size:16px;font-style:normal;font-weight:normal;line-height:19px;color:#333333">\n                                <em>После того, как вы нажмете на кнопку, вам будет предложено выполнить следующие\n                                  действия:</em></h6><ol style="font-family:arial, \'helvetica neue\', helvetica, sans-serif;padding:0 0 0\n                                40px;margin:15px 0">\n                                <li style="color:#333333;margin:0 0 10px">Введите новый пароль.</li>\n                                <li style="color:#333333;margin:0 0 10px">Нажмите кнопку отправить.</li> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </ol>\n                              </td>\n                            </tr>\n                          </table>\n                        </td>\n                      </tr>\n                    </table>\n                  </td>\n                </tr>\n                <tr>\n                  <td align="left" style="padding:0;Margin:0;padding-right:20px;padding-left:20px;padding-bottom:20px">\n                    <table cellpadding="0" cellspacing="0" width="100%"\n                           style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0">\n                      <tr>\n                        <td align="center" valign="top" style="padding:0;Margin:0;width:554px">\n                          <table cellpadding="0" cellspacing="0" width="100%"\n                                 style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:separate;border-spacing:0;border-radius:5px"\n                                 >\n                            <tr>\n                              <td align="center" style="Margin:0;padding-top:10px;padding-bottom:10px"><span\n                                class="es-button-border"\n                                style="border-style:solid;border-color:#2CB543;background:#5C68E2;border-width:0;display:inline-block;border-radius:6px;width:auto"><a\n                                href="https://saturday-one.vercel.app/new-password/##token##" class="es-button" target="_blank"\n                                style="text-decoration:none !important;mso-line-height-rule:exactly;color:#FFFFFF;font-size:20px;padding:10px 30px 10px 30px;display:inline-block;background:#5C68E2;border-radius:6px;font-family:arial, \'helvetica neue\', helvetica, sans-serif;font-weight:normal;font-style:normal;line-height:24px;width:auto;text-align:center;letter-spacing:0;mso-padding-alt:0;mso-border-alt:10px solid #5C68E2;border-left-width:30px;border-right-width:30px">Сбросить пароль</a></span>\n                              </td>\n                            </tr>\n                            <tr>\n                              <td align="center" class="es-m-txt-c" style="Margin:0;padding-top:10px"><h3\n                                style="Margin:0;font-family:arial, \'helvetica neue\', helvetica, sans-serif;mso-line-height-rule:exactly;letter-spacing:0;font-size:20px;font-style:normal;font-weight:bold;line-height:30px;color:#333333">\n                                Ссылка действительна только для однократного использования. Истекает через 2 часа.</h3>\n                              </td>\n                            </tr>\n                            <tr>\n                              <td align="center" style="Margin:0;padding-top:10px;padding-bottom:10px"><p\n                                style="Margin:0;mso-line-height-rule:exactly;font-family:arial, \'helvetica neue\', helvetica, sans-serif;line-height:21px;letter-spacing:0;color:#333333;font-size:14px">\n                                Если вы не запрашивали сброс своего пароля, пожалуйста, не обращайте внимания на это\n                                сообщение.</p></td>\n                            </tr>\n                          </table>\n                        </td>\n                      </tr>\n                    </table>\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n        </table>\n        <table cellpadding="0" cellspacing="0" class="es-content" align="center"\n               style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0;width:100%;table-layout:fixed !important">\n          <tr>\n            <td class="es-info-area" align="center" style="padding:0;Margin:0">\n              <table class="es-content-body" align="center" cellpadding="0" cellspacing="0"\n                     style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0;background-color:transparent;width:600px"\n                     bgcolor="#FFFFFF">\n                <tr>\n                  <td align="left" style="padding:20px;Margin:0">\n                    <table cellpadding="0" cellspacing="0" width="100%"\n                           style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0">\n                      <tr>\n                        <td align="center" valign="top" style="padding:0;Margin:0;width:560px">\n                          <table cellpadding="0" cellspacing="0" width="100%"\n                                 style="mso-table-lspace:0;mso-table-rspace:0;border-collapse:collapse;border-spacing:0">\n                          </table>\n                        </td>\n                      </tr>\n                    </table>\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n  </table>\n</div>\n</body>\n</html>\n\n',
          },
          method: 'POST',
          url: '/v1/auth/recover-password',
        }),
      }),
      singUp: builder.mutation<User, SingUpFormData>({
        invalidatesTags: ['Me'],
        query: body => ({
          body,
          method: 'POST',
          url: '/v1/auth/sign-up',
        }),
      }),
    }
  },
})

export const {
  useLoginMutation,
  useLogoutMutation,
  useMeQuery,
  usePatchUserMutation,
  useRecoverPasswordMutation,
  useSingUpMutation,
} = authService
